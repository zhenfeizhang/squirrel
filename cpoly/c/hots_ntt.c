// NTT functions for large ring with q = 0x662801 and n = 512
#include "params.h"
#include <stdint.h>

/// NTT forward table where the i-th element is g^rev(i) where
/// - g = 10516887 is a primitive root
/// - rev(i) is the reverse bit decomposition of i, i.e.,
///   0   ->  0
///   1   ->  100 0000
///   2   ->  010 0000
///   3   ->  110 0000   ...
static const uint32_t HOTS_NTT_TABLE[] = {
    1,       3907658, 2638481, 1553977, 5395941, 4115851, 480732,  3912073,
    1411215, 6000587, 1065596, 3254862, 5357550, 4828077, 590351,  3550809,
    657937,  5596373, 3502275, 5326654, 4073164, 5554234, 3595025, 4795986,
    6554050, 4623093, 3746092, 5708210, 5120546, 1651474, 1693279, 5339857,
    2481694, 3152500, 3061381, 4576909, 3150236, 1255580, 2918321, 258929,
    1079128, 5260044, 5954450, 4978729, 3742785, 4265294, 2638065, 2832108,
    2753360, 2090883, 4475295, 6163550, 5487114, 528477,  3789942, 213275,
    2715286, 2971790, 4119266, 2989433, 529798,  1446094, 4291916, 370297,
    4379382, 5581362, 5174130, 6193671, 6455361, 2141357, 6640905, 5644148,
    1311092, 3579460, 3004500, 4193811, 256255,  5458293, 4684785, 950895,
    797994,  4704955, 2122831, 5756626, 1517622, 508789,  2736708, 6324227,
    3176806, 3017836, 4924468, 1899348, 1651856, 1334124, 2307736, 2773591,
    5285776, 6573094, 5259088, 5656191, 123486,  5201313, 828708,  4807416,
    1431848, 5870842, 4506466, 4523946, 3405013, 2210355, 4367554, 786977,
    1571697, 2271033, 3305840, 3082526, 3239127, 4711679, 3940676, 5383420,
    4484607, 727778,  1295245, 173471,  5470469, 5335775, 4902977, 3409942,
    2374344, 5924954, 3810322, 2293180, 6146472, 2129078, 727525,  4419956,
    6335155, 6689715, 3507368, 3052499, 3946463, 3584152, 2504673, 5052526,
    4548560, 6162301, 1483386, 2375980, 2794657, 2460357, 6116077, 3315701,
    549869,  1144017, 4482237, 5337910, 2443476, 3703347, 4374129, 5257146,
    1480046, 5878610, 4141269, 420748,  6378933, 1029750, 3594597, 6046612,
    4242889, 1251939, 3747093, 749763,  5659578, 830470,  235429,  1240300,
    1929252, 3363775, 5104226, 4414152, 2200129, 5514889, 179661,  5082019,
    2566035, 1758714, 2974195, 2239265, 2109116, 5005721, 3942805, 3010443,
    2113849, 1906416, 5860633, 274197,  869853,  365218,  792850,  1841029,
    2861647, 5371477, 5560154, 5032694, 3828280, 6632391, 1172538, 6242151,
    5022545, 2978329, 5541597, 3225891, 530369,  3312783, 4509142, 3962648,
    6533814, 2873248, 3375751, 5435999, 194587,  4703271, 1309116, 1281941,
    95709,   114603,  954582,  2092398, 1223262, 1997352, 2936852, 890319,
    2801573, 459304,  3517835, 5285268, 2366280, 831420,  3533052, 3899788,
    4835568, 3443805, 5028804, 4492562, 364199,  699880,  4583916, 2398968,
    1697915, 4807767, 2043339, 2085351, 1315688, 724049,  4975733, 2799932,
    894916,  4810308, 3386452, 4857659, 392403,  628306,  6344045, 5865778,
    3884446, 4818740, 2197129, 5333552, 1965763, 574070,  5580860, 2280724,
    834681,  87019,   5023124, 2631717, 522592,  1666624, 4950750, 3001484,
    4659282, 4423839, 153000,  2553274, 4832852, 1681782, 2471318, 1686220,
    4178214, 6436539, 6625875, 1321244, 2210441, 4602838, 69301,   2071121,
    1102824, 3782309, 3607719, 5996221, 6512247, 1978006, 6016524, 5548518,
    3357588, 3416458, 2330099, 1030056, 1664140, 478786,  3334507, 4630096,
    738061,  1789694, 3886118, 4187828, 4358134, 5975204, 5931304, 6601291,
    3731364, 3193334, 2349977, 3075154, 5586454, 2828631, 4648532, 984501,
    230457,  1002250, 4332418, 591293,  5844591, 4789893, 634200,  843129,
    4618620, 1604472, 219403,  1329394, 768746,  2383594, 4092694, 106774,
    6492498, 1902315, 5163134, 5537937, 2099131, 4993555, 3192675, 5358432,
    1260101, 2191088, 5191477, 6342872, 3363198, 6232676, 1755866, 2064300,
    4116220, 3818479, 54264,   3869176, 4267045, 3060200, 3322369, 240984,
    2520282, 2333905, 529305,  3105644, 3232331, 292869,  1800814, 2433529,
    621206,  5650182, 5017252, 330792,  1968745, 4061606, 313514,  3360342,
    252251,  5207342, 4779575, 5096077, 2140987, 507300,  168563,  845036,
    5175842, 1191167, 3594559, 4843694, 5511957, 2237671, 1680242, 2795528,
    5067830, 1330443, 5041371, 4843793, 4783880, 3247398, 2600686, 1400647,
    3765591, 6326699, 1957707, 6657061, 6589043, 1701462, 2566542, 1247072,
    1953129, 6206273, 4983733, 5515135, 4177614, 5061289, 3536743, 6222864,
    2649461, 6636313, 5540487, 4029135, 4627775, 5293303, 266854,  1298704,
    843827,  2081493, 1408985, 2005060, 3595255, 6438984, 3167781, 5206070,
    3839408, 895767,  4995601, 5937928, 4916905, 6322789, 5721686, 362371,
    2674404, 4111440, 6177280, 1331176, 1053186, 473941,  575947,  1778568,
    2260805, 6227802, 3893161, 3035779, 1194990, 4144702, 2522666, 5566594,
    5530236, 2291456, 321189,  1425252, 6541782, 1051829, 4765539, 1935685,
    4878771, 371258,  1039796, 4373329, 4332562, 921353,  6028386, 2610102,
    3493435, 686101,  6501225, 146859,  4731710, 830388,  458196,  5816987,
    1228411, 4314829, 4497044, 1896857, 765841,  5209552, 4980774, 4869864,
    2781913, 29699,   3167299, 2985467, 5757618, 4614191, 5559088, 3705152,
    455834,  1518905, 1702269, 281853,  2587811, 2575092, 2793085, 5552115,
    6693967, 5642421, 1199523, 2818618, 3658433, 2844320, 481612,  1465831,
    3973210, 730922,  2878047, 560528,  6501754, 5264737, 3900646, 1781012,
    218507,  1507325, 829785,  2254805, 3056744, 1201341, 122154,  2148258,
    6053051, 5027124, 4500858, 2828131, 3080496, 4315238, 4937186, 3154593,
    2231939, 3666198, 2830903, 1852797, 5807942, 3915834, 4267403, 2764947,
    3466601, 5013648, 4207046, 3341118, 934367,  2064415, 1593059, 5485945,
    6337510, 3718930, 4250859, 550923,  4442644, 2179233, 3188236, 5784153,
    2186036, 550120,  6308643, 3944581, 929567,  4452241, 3659655, 4529427,
    1255775, 2317905, 5949336, 5531022, 5684063, 2834917, 4227177, 3176566,
    4960786, 1456818, 3081025, 2738203, 5294551, 4927658, 225796,  4266585,
    1622845, 1229715, 275774,  3890986, 3735883, 719342,  2005563, 2533480,
    757461,  3854995, 1112720, 4148389, 3953866, 3257253, 6118295, 588810,
    755915,  1427253, 5918024, 5173714, 3690678, 318957,  6041966, 4725304,
    4539131, 2961258, 1542745, 5091404, 5805768, 4511939, 5750150, 5350014,
    6140237, 669855,  5894644, 2912472, 2056012, 1563724, 1187045, 2113473,
    2136620, 1098051, 6562222, 3269259, 104075,  321252,  1358467, 1142934,
    3361344, 5330610, 3993495, 6498445, 3316885, 1061025, 1337389, 3042249,
    5585418, 4917308, 2706720, 4538362, 2407456, 3713099, 578544,  478286,
    1891299, 1732477, 2648574, 1813688, 745113,  2332002, 5290903, 3261051,
    2027140, 2335824, 4378640, 4996455, 4911602, 4768150, 6225113, 1060243,
    5808214, 2307643, 5578544, 3667172, 4340908, 3313798, 527042,  4055663,
    3174806, 665307,  3553912, 384980,  1969612, 4375114, 4911208, 4980888,
    2638857, 4647438, 5129390, 1837920, 795909,  4947146, 4108432, 6052473,
    2784309, 3289893, 4969903, 3942731, 6555251, 4586338, 5867924, 4153860,
    2077833, 4156974, 5924059, 1711245, 593361,  2639248, 6489069, 5758859,
    4321703, 21725,   2295934, 5849532, 395053,  5586508, 2134610, 6533333,
    2060660, 1059139, 6461030, 1187442, 389401,  6021479, 5706162, 486272,
    5111568, 42070,   13055,   5933043, 3378262, 2822779, 135169,  5757980,
    3188068, 5399083, 778683,  2285740, 1014097, 5165387, 126903,  1317264,
    897490,  667761,  6194764, 1236483, 4294975, 3476414, 5189308, 6392528,
    4873164, 2583101, 2834559, 1306103, 3603222, 709907,  1919088, 151779,
    551530,  4393258, 1831163, 2257289, 612970,  4625685, 6175334, 2449876,
    3663415, 1989472, 3279735, 4059817, 3701890, 1469781, 3870391, 1056889,
    821321,  707713,  3633909, 2424210, 1574016, 5912646, 2792797, 4891995,
    391508,  4713895, 1512926, 903354,  1051530, 3373164, 3029600, 5934161,
    4266895, 6063844, 2550086, 1466389, 747587,  2423522, 5352722, 4920087,
    4103139, 3404936, 5055731, 2051907, 4430583, 4103615, 1390384, 2329043,
    1134924, 3714141, 1503456, 4861158, 5429211, 3381964, 5739259, 6608677,
    3805427, 1673711, 5047636, 3024322, 5723028, 2322528, 5555314, 5097199,
    4760159, 762465,  5934522, 1703208, 1271644, 4658501, 6018423, 1532543,
    5043720, 5206712, 6327787, 3191471, 4195786, 2080274, 1046569, 5949874,
    2919807, 2549146, 5514241, 3009514, 1015052, 1217323, 2588970, 5789526,
    2563669, 1914739, 6681978, 1036920, 2511801, 1305757, 4666103, 6110404,
    4027026, 1341607, 2961726, 3228477, 2611235, 2705548, 5830126, 5667382,
    6333881, 2653782, 2928900, 4980049, 5193280, 2106857, 5984101, 2086796,
    2495246, 2971886, 2225560, 1876915, 407969,  3948129, 3648036, 6351091,
    5897169, 1447160, 1395945, 1127583, 1790115, 4132272, 3632771, 931638,
    1491468, 4163315, 372925,  1731679, 5447957, 600786,  4686841, 1200143,
    2387422, 1310436, 4283238, 6143431, 3184937, 2127936, 1217314, 3985504,
    4329784, 4596315, 562990,  3880881, 1025905, 5450655, 3880362, 6616060,
    6085441, 44566,   4336003, 3787227, 210708,  926559,  3479028, 580712,
    6139543, 194968,  2500079, 2333427, 6424238, 3890981, 2304687, 5269489,
    135954,  304443,  5302247, 4714430, 4670739, 5578314, 1697622, 4694096,
    4202269, 1876296, 816177,  4538700, 597952,  330286,  1962810, 3290008,
    5129218, 5906957, 6082790, 4568532, 6599487, 1091966, 2600198, 2513748,
    3257791, 2858369, 770032,  6447032, 1572405, 3893828, 3469661, 5332510,
    690930,  322213,  952169,  6046061, 1228081, 210985,  4137004, 4592748,
    3650630, 22748,   5966757, 270743,  979757,  2330926, 3641905, 2898607,
    3818710, 1434436, 4121204, 4084034, 4268753, 2511803, 4171468, 3248152,
    4172604, 3620321, 505195,  287000,  5378017, 5433665, 1212720, 1266405,
    2497512, 355015,  2466197, 1664559, 2699137, 4452686, 1715929, 348784,
    2838056, 2068696, 3761044, 6504875, 5259931, 5914689, 1406548, 5903713,
    6106024, 5379311, 3056170, 1001504, 2952554, 58590,   3304370, 3060620,
    3950381, 2522165, 3127559, 1163582, 2268952, 911300,  2232225, 3205915,
};

/// NTT reverse table where the i-th element is (1/g)^rev(i) where
/// - g = 10516887 is a primitive root
/// - 1/g = 4800153
/// - rev(i) is the reverse bit decomposition of i, i.e.,
///   0   ->  0
///   1   ->  100 0000
///   2   ->  010 0000
///   3   ->  110 0000   ...
static const uint32_t HOTS_INV_NTT_TABLE[] = {
    1,       2787255, 5140936, 4056432, 2782840, 6214181, 2579062, 1298972,
    3144104, 6104562, 1866836, 1337363, 3440051, 5629317, 694326,  5283698,
    1355056, 5001634, 5043439, 1574367, 986703,  2948821, 2071820, 140863,
    1898927, 3099888, 1140679, 2621749, 1368259, 3192638, 1098540, 6036976,
    6324616, 2402997, 5248819, 6165115, 3705480, 2575647, 3723123, 3979627,
    6481638, 2904971, 6166436, 1207799, 531363,  2219618, 4604030, 3941553,
    3862805, 4056848, 2429619, 2952128, 1716184, 740463,  1434869, 5615785,
    6435984, 3776592, 5439333, 3544677, 2118004, 3633532, 3542413, 4213219,
    3284971, 1791936, 1359138, 1224444, 6521442, 5399668, 5967135, 2210306,
    1311493, 2754237, 1983234, 3455786, 3612387, 3389073, 4423880, 5123216,
    5907936, 2327359, 4484558, 3289900, 2170967, 2188447, 824071,  5263065,
    1887497, 5866205, 1493600, 6571427, 1038722, 1435825, 121819,  1409137,
    3921322, 4387177, 5360789, 5043057, 4795565, 1770445, 3677077, 3518107,
    370686,  3958205, 6186124, 5177291, 938287,  4572082, 1989958, 5896919,
    5744018, 2010128, 1236620, 6438658, 2501102, 3690413, 3115453, 5383821,
    1050765, 54008,   4553556, 239552,  501242,  1520783, 1113551, 2315531,
    3894981, 1719180, 5970864, 5379225, 4609562, 4651574, 1887146, 4996998,
    4295945, 2110997, 5995033, 6330714, 2202351, 1666109, 3251108, 1859345,
    2795125, 3161861, 5863493, 4328633, 1409645, 3177078, 6235609, 3893340,
    5804594, 3758061, 4697561, 5471651, 4602515, 5740331, 6580310, 6599204,
    5412972, 5385797, 1991642, 6500326, 1258914, 3319162, 3821665, 161099,
    2732265, 2185771, 3382130, 6164544, 3469022, 1153316, 3716584, 1672368,
    452762,  5522375, 62522,   2866633, 1662219, 1134759, 1323436, 3833266,
    4853884, 5902063, 6329695, 5825060, 6420716, 834280,  4788497, 4581064,
    3684470, 2752108, 1689192, 4585797, 4455648, 3720718, 4936199, 4128878,
    1612894, 6515252, 1180024, 4494784, 2280761, 1590687, 3331138, 4765661,
    5454613, 6459484, 5864443, 1035335, 5945150, 2947820, 5442974, 2452024,
    648301,  3100316, 5665163, 315980,  6274165, 2553644, 816303,  5214867,
    1437767, 2320784, 2991566, 4251437, 1357003, 2212676, 5550896, 6145044,
    3379212, 578836,  4234556, 3900256, 4318933, 5211527, 532612,  2146353,
    1642387, 4190240, 3110761, 2748450, 3642414, 3187545, 5198,    359758,
    2274957, 5967388, 4565835, 548441,  4401733, 2884591, 769959,  4320569,
    1142798, 3901828, 4119821, 4107102, 6413060, 4992644, 5176008, 6239079,
    2989761, 1135825, 2080722, 937295,  3709446, 3527614, 6665214, 3913000,
    1825049, 1714139, 1485361, 5929072, 4798056, 2197869, 2380084, 5466502,
    877926,  6236717, 5864525, 1963203, 6548054, 193688,  6008812, 3201478,
    4084811, 666527,  5773560, 2362351, 2321584, 5655117, 6323655, 1816142,
    4759228, 1929374, 5643084, 153131,  5269661, 6373724, 4403457, 1164677,
    1128319, 4172247, 2550211, 5499923, 3659134, 2801752, 467111,  4434108,
    4916345, 6118966, 6220972, 5641727, 5363737, 517633,  2583473, 4020509,
    6332542, 973227,  372124,  1778008, 756985,  1699312, 5799146, 2855505,
    1488843, 3527132, 255929,  3099658, 4689853, 5285928, 4613420, 5851086,
    5396209, 6428059, 1401610, 2067138, 2665778, 1154426, 58600,   4045452,
    472049,  3158170, 1633624, 2517299, 1179778, 1711180, 488640,  4741784,
    5447841, 4128371, 4993451, 105870,  37852,   4737206, 368214,  2929322,
    5294266, 4094227, 3447515, 1911033, 1851120, 1653542, 5364470, 1627083,
    3899385, 5014671, 4457242, 1182956, 1851219, 3100354, 5503746, 1519071,
    5849877, 6526350, 6187613, 4553926, 1598836, 1915338, 1487571, 6442662,
    3334571, 6381399, 2633307, 4726168, 6364121, 1677661, 1044731, 6073707,
    4261384, 4894099, 6402044, 3462582, 3589269, 6165608, 4361008, 4174631,
    6453929, 3372544, 3634713, 2427868, 2825737, 6640649, 2876434, 2578693,
    4630613, 4939047, 462237,  3331715, 352041,  1503436, 4503825, 5434812,
    1336481, 3502238, 1701358, 4595782, 1156976, 1531779, 4792598, 202415,
    6588139, 2602219, 4311319, 5926167, 5365519, 6475510, 5090441, 2076293,
    5851784, 6060713, 1905020, 850322,  6103620, 2362495, 5692663, 6464456,
    5710412, 2046381, 3866282, 1108459, 3619759, 4344936, 3501579, 2963549,
    93622,   763609,  719709,  2336779, 2507085, 2808795, 4905219, 5956852,
    2064817, 3360406, 6216127, 5030773, 5664857, 4364814, 3278455, 3337325,
    1146395, 678389,  4716907, 182666,  698692,  3087194, 2912604, 5592089,
    4623792, 6625612, 2092075, 4484472, 5373669, 69038,   258374,  2516699,
    5008693, 4223595, 5013131, 1862061, 4141639, 6541913, 2271074, 2035631,
    3693429, 1744163, 5028289, 6172321, 4063196, 1671789, 6607894, 5860232,
    4414189, 1114053, 6120843, 4729150, 1361361, 4497784, 1876173, 2810467,
    829135,  350868,  6066607, 6302510, 1837254, 3308461, 1884605, 5799997,
    3488998, 4462688, 5783613, 4425961, 5531331, 3567354, 4172748, 2744532,
    3634293, 3390543, 6636323, 3742359, 5693409, 3638743, 1315602, 588889,
    791200,  5288365, 780224,  1434982, 190038,  2933869, 4626217, 3856857,
    6346129, 4978984, 2242227, 3995776, 5030354, 4228716, 6339898, 4197401,
    5428508, 5482193, 1261248, 1316896, 6407913, 6189718, 3074592, 2522309,
    3446761, 2523445, 4183110, 2426160, 2610879, 2573709, 5260477, 2876203,
    3796306, 3053008, 4363987, 5715156, 6424170, 728156,  6672165, 3044283,
    2102165, 2557909, 6483928, 5466832, 648852,  5742744, 6372700, 6003983,
    1362403, 3225252, 2801085, 5122508, 247881,  5924881, 3836544, 3437122,
    4181165, 4094715, 5602947, 95426,   2126381, 612123,  787956,  1565695,
    3404905, 4732103, 6364627, 6096961, 2156213, 5878736, 4818617, 2492644,
    2000817, 4997291, 1116599, 2024174, 1980483, 1392666, 6390470, 6558959,
    1425424, 4390226, 2803932, 270675,  4361486, 4194834, 6499945, 555370,
    6114201, 3215885, 5768354, 6484205, 2907686, 2358910, 6650347, 609472,
    78853,   2814551, 1244258, 5669008, 2814032, 6131923, 2098598, 2365129,
    2709409, 5477599, 4566977, 3509976, 551482,  2411675, 5384477, 4307491,
    5494770, 2008072, 6094127, 1246956, 4963234, 6321988, 2531598, 5203445,
    5763275, 3062142, 2562641, 4904798, 5567330, 5298968, 5247753, 797744,
    343822,  3046877, 2746784, 6286944, 4817998, 4469353, 3723027, 4199667,
    4608117, 710812,  4588056, 1501633, 1714864, 3766013, 4041131, 361032,
    1027531, 864787,  3989365, 4083678, 3466436, 3733187, 5353306, 2667887,
    584509,  2028810, 5389156, 4183112, 5657993, 12935,   4780174, 4131244,
    905387,  4105943, 5477590, 5679861, 3685399, 1180672, 4145767, 3775106,
    745039,  5648344, 4614639, 2499127, 3503442, 367126,  1488201, 1651193,
    5162370, 676490,  2036412, 5423269, 4991705, 760391,  5932448, 1934754,
    1597714, 1139599, 4372385, 971885,  3670591, 1647277, 5021202, 2889486,
    86236,   955654,  3312949, 1265702, 1833755, 5191457, 2980772, 5559989,
    4365870, 5304529, 2591298, 2264330, 4643006, 1639182, 3289977, 2591774,
    1774826, 1342191, 4271391, 5947326, 5228524, 4144827, 631069,  2428018,
    760752,  3665313, 3321749, 5643383, 5791559, 5181987, 1981018, 6303405,
    1802918, 3902116, 782267,  5120897, 4270703, 3061004, 5987200, 5873592,
    5638024, 2824522, 5225132, 2993023, 2635096, 3415178, 4705441, 3031498,
    4245037, 519579,  2069228, 6081943, 4437624, 4863750, 2301655, 6143383,
    6543134, 4775825, 5985006, 3091691, 5388810, 3860354, 4111812, 1821749,
    302385,  1505605, 3218499, 2399938, 5458430, 500149,  6027152, 5797423,
    5377649, 6568010, 1529526, 5680816, 4409173, 5916230, 1295830, 3506845,
    936933,  6559744, 3872134, 3316651, 761870,  6681858, 6652843, 1583345,
    6208641, 988751,  673434,  6305512, 5507471, 233883,  5635774, 4634253,
    161580,  4560303, 1108405, 6299860, 845381,  4398979, 6673188, 2373210,
    936054,  205844,  4055665, 6101552, 4983668, 770854,  2537939, 4617080,
    2541053, 826989,  2108575, 139662,  2752182, 1725010, 3405020, 3910604,
    642440,  2586481, 1747767, 5899004, 4856993, 1565523, 2047475, 4056056,
    1714025, 1783705, 2319799, 4725301, 6309933, 3141001, 6029606, 3520107,
    2639250, 6167871, 3381115, 2354005, 3027741, 1116369, 4387270, 886699,
    5634670, 469800,  1926763, 1783311, 1698458, 2316273, 4359089, 4667773,
    3433862, 1404010, 4362911, 5949800, 4881225, 4046339, 4962436, 4803614,
    6216627, 6116369, 2981814, 4287457, 2156551, 3988193, 1777605, 1109495,
    3652664, 5357524, 5633888, 3378028, 196468,  2701418, 1364303, 3333569,
    5551979, 5336446, 6373661, 6590838, 3425654, 132691,  5596862, 4558293,
    4581440, 5507868, 5131189, 4638901, 3782441, 800269,  6025058, 554676,
    1344899, 944763,  2182974, 889145,  1603509, 5152168, 3733655, 2155782,
    1969609, 652947,  6375956, 3004235, 1521199, 776889,  5267660, 5938998,
    6106103, 576618,  3437660, 2741047, 2546524, 5582193, 2839918, 5937452,
    4161433, 4689350, 5975571, 2959030, 2803927, 6419139, 5465198, 5072068,
    2428328, 6469117, 1767255, 1400362, 3956710, 3613888, 5238095, 1734127,
    3518347, 2467736, 3859996, 1010850, 1163891, 745577,  4377008, 5439138,
    2165486, 3035258, 2242672, 5765346, 2750332, 386270,  6144793, 4508877,
    910760,  3506677, 4515680, 2252269, 6143990, 2444054, 2975983, 357403,
    1208968, 5101854, 4630498, 5760546, 3353795, 2487867, 1681265, 3228312,
    3929966, 2427510, 2779079, 886971,  4842116, 3864010, 3028715, 4462974,
    3540320, 1757727, 2379675, 3614417, 3866782, 2194055, 1667789, 641862,
    4546655, 6572759, 5493572, 3638169, 4440108, 5865128, 5187588, 6476406,
    4913901, 2794267, 1430176, 193159,  6134385, 3816866, 5963991, 2721703,
    5229082, 6213301, 3850593, 3036480, 3876295, 5495390, 1052492, 946,
};

/// convert a polynomial into its NTT form
void hots_ntt(uint32_t *p) {
  unsigned int t, ht, i, j, j1, j2, l, m;
  uint32_t u, v, s;

  t = N;
  for (l = 0; l < 9; l++) {
    m = 1 << l;
    ht = t >> 1;
    i = 0;
    j1 = 0;
    while (i < m) {
      s = HOTS_NTT_TABLE[m + i];
      j2 = j1 + ht;
      j = j1;
      while (j < j2) {
        u = p[j];
        v = (uint32_t)(((uint64_t)p[j + ht]) * ((uint64_t)s) % 0x662801);
        p[j] = ((u + v) % 0x662801);
        p[j + ht] = (u + 0x662801 - v) % 0x662801;
        j++;
      }
      i++;
      j1 += t;
    }
    t = ht;
  }
}

/// convert an NTT form polynomial into its integer form
void hots_inv_ntt(uint32_t *p) {
  unsigned int t, m, hm, dt, i, j, j1, j2;
  uint32_t s, u, v;

  t = 1;
  m = N;

  while (m > 1) {
    hm = m >> 1;
    dt = t << 1;
    i = 0;
    j1 = 0;
    while (i < hm) {
      j2 = j1 + t;
      s = HOTS_INV_NTT_TABLE[hm + i];
      j = j1;
      while (j < j2) {
        u = p[j];
        v = p[j + t];
        p[j] = (u + v) % 0x662801;
        p[j + t] = (uint32_t)(((uint64_t)(u + 0x662801 - v)) * ((uint64_t)s) %
                              0x662801);
        j++;
      }
      i++;
      j1 += dt;
    }
    t = dt;
    m = hm;
  }

  for (i = 0; i < N; i++) {
    p[i] = (uint32_t)(((uint64_t)p[i]) * 6681837 % 0x662801);
  }
}
