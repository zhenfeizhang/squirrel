// NTT functions for large ring with q = 28930049 and n = 512
#include "params.h"
#include <stdint.h>

/// NTT forward table where the i-th element is g^rev(i) where
/// - g = 10516887 is a primitive root
/// - rev(i) is the reverse bit decomposition of i, i.e.,
///   0   ->  0
///   1   ->  100 0000
///   2   ->  010 0000
///   3   ->  110 0000   ...
static const uint32_t HOTS_NTT_TABLE[] = {
    1,        2068501,  6983048,  15465936, 18956325, 25265303, 16573220,
    19098906, 28387479, 5733336,  2583876,  10327273, 19905132, 18969450,
    21574976, 18682988, 19082390, 15382182, 22058319, 20598440, 27256626,
    3213927,  5839070,  256864,   11453918, 3628074,  5551176,  16288635,
    8459294,  7261134,  25456090, 18275602, 7551455,  19792434, 12710237,
    1224370,  14437592, 2137431,  12320218, 18809314, 25250275, 24343371,
    7141285,  14284287, 14006339, 12936593, 25371729, 23518309, 16419773,
    5393538,  8653709,  27201949, 11572980, 1986999,  533941,   23941817,
    16632744, 18263886, 17270423, 21258959, 28586703, 21158604, 5142316,
    1092192,  20205882, 8871504,  25283870, 25656768, 17221441, 14974575,
    14576077, 22083267, 23461957, 27487438, 12729312, 26224158, 18912699,
    17663508, 7537142,  8777748,  9851370,  23292093, 28569003, 5202889,
    19646379, 22966746, 21026225, 26093301, 172242,   9195807,  7366441,
    4836592,  1070461,  1558599,  18764312, 26825511, 18460942, 27370000,
    14984962, 2202088,  1880875,  20968757, 27091049, 9873961,  10774183,
    412288,   23348473, 24137540, 1129725,  12584250, 17770039, 9314148,
    2742300,  19864674, 3055928,  3347477,  16810233, 3186016,  10317637,
    27074298, 11639119, 372917,   13043377, 16810379, 19499371, 20516777,
    10964557, 22324723, 13941082, 16375470, 9810192,  16622171, 23136000,
    28828975, 26677647, 1811901,  8820751,  13240735, 8121874,  20015888,
    22321394, 17277325, 22623282, 17799548, 5161580,  12017983, 17867426,
    14489848, 8900159,  3949921,  15748275, 621628,   26002796, 4567898,
    14374884, 12916439, 15580401, 462901,   6265498,  18737331, 17615025,
    23363250, 18025011, 24357850, 16515815, 5720097,  18153807, 22191405,
    4733488,  23157732, 1776229,  15239729, 10143053, 4767332,  15928893,
    6482460,  13011249, 12332804, 1536768,  1290697,  17546505, 17984781,
    13656462, 6118000,  26117099, 24077273, 17658518, 16224853, 6516923,
    16110383, 6492589,  19492309, 28591422, 4058261,  6820017,  23260598,
    20456590, 27491887, 436570,   22932084, 23040240, 4288669,  19153753,
    28709047, 25912795, 2274712,  9456312,  3588089,  3266110,  4248287,
    22683493, 20452314, 13340458, 25985151, 15302113, 11571615, 16848795,
    8576485,  9718521,  2608146,  21312495, 6701590,  22661855, 17013479,
    478825,   833761,   9685327,  20722278, 17304473, 9048694,  14975555,
    13736158, 24689819, 5470443,  1950166,  1078753,  12326752, 24061965,
    6685790,  16257124, 3365835,  14261142, 3005765,  13217577, 27729227,
    3569269,  5967243,  11266501, 8247175,  20950698, 6806178,  9093720,
    25289060, 28128779, 1539227,  24976081, 15786237, 8903604,  8379110,
    2547867,  25988807, 27286458, 25291885, 27774206, 7418046,  26879936,
    16697503, 26193275, 19239051, 23338494, 3538112,  9064337,  19885502,
    3153567,  14914898, 14293514, 17144413, 259390,   20755790, 22452830,
    11374116, 7970866,  23888567, 17414401, 8073854,  7456085,  15473734,
    9150457,  14135631, 24194929, 28644553, 328741,   12422003, 8286977,
    18234279, 15101931, 18118622, 1056955,  10082374, 17677764, 27347820,
    14174641, 9679794,  3075600,  16515765, 18015243, 16161995, 1075879,
    24900378, 5084807,  4743622,  11061341, 8341504,  7401022,  2455289,
    10859692, 19071344, 21458846, 14820745, 15808729, 19675411, 16906054,
    11092369, 9856724,  3344227,  15017239, 12440165, 25198537, 16054926,
    17197454, 18235287, 17187411, 15429890, 13496228, 9408140,  23776722,
    8420829,  4919,     9089686,  9644949,  3465047,  4614748,  17280538,
    27721147, 4517991,  21592727, 1310157,  9794533,  17613524, 14058492,
    9147701,  11887212, 18740471, 8496666,  11143226, 17953917, 16676960,
    2289164,  9307814,  14586873, 26971560, 25096628, 24019543, 11492492,
    4308481,  22082237, 4431656,  22751369, 19562088, 28354278, 23704211,
    3819914,  16514747, 24174802, 24211185, 23629736, 25360911, 9402368,
    6681268,  6901429,  11006833, 14734872, 4703980,  28233614, 6064703,
    22792529, 20954673, 26840433, 24766502, 873959,   16743009, 17020335,
    6796599,  12006206, 16607194, 23262859, 12819625, 8498529,  12433262,
    8850291,  8215225,  8575664,  6960466,  26605489, 21281125, 7925127,
    22777123, 7522889,  4811327,  8554337,  17488889, 2102996,  3305532,
    23816627, 10055465, 17798631, 22744101, 5328556,  15134650, 22595378,
    21211776, 23562269, 15471582, 12963851, 19101674, 9817895,  13777856,
    25833123, 20928762, 8361770,  13562247, 24036398, 28078000, 12236629,
    28392282, 17736832, 15386922, 7255788,  24269904, 6664204,  22972959,
    15938627, 16697025, 21071463, 6620635,  28172760, 26450148, 25009985,
    19447572, 2204925,  8463852,  4292718,  9157811,  8006895,  23354212,
    5014640,  16561779, 18159047, 8078424,  379632,   11331529, 8717984,
    8797062,  20023552, 19249535, 11966228, 20789374, 1012716,  5372173,
    24101283, 26644122, 643329,   19294883, 23130718, 19733724, 28030586,
    9322287,  9401131,  15281711, 18955704, 1728805,  20444464, 21360283,
    2249945,  3514719,  20592421, 7953284,  14242944, 1249877,  9065443,
    15672237, 8619003,  952103,   12921928, 21739009, 562800,   15257927,
    2811220,  11998808, 23358973, 11780534, 5716393,  22483731, 20445419,
    13649254, 24268076, 22460057, 395653,   11763631, 18273231, 22623307,
    11651975, 28919921, 24507397, 9659661,  17215527, 19075613, 28224670,
    27502187, 21517695, 27369699, 24311384, 12198217, 16436240, 14334585,
    1865809,  26233218, 10148045, 15211449, 26504618, 20113595, 22513068,
    24349479, 24582518, 23849245, 2185818,  4214986,  24958807, 17704728,
    16774167, 15075506, 28349455, 5317168,  28086495, 9913316,  27468018,
    9437714,  10571661, 17465919, 20705533, 25063482, 3640473,  6847960,
    21146139, 27118069, 7916313,  16758904, 2378017,  20753955, 16589914,
    19390757, 23109697, 13283718, 28447204, 13417108, 10988232, 2164715,
    8948142,  3244095,  2095898,  25162159, 15617955, 5802408,  19461680,
    21641801, 18488191, 5993730,  6139682,  13758388, 26883863, 510973,
    17751307, 3532191,  27810692, 8721990,  1089463,  18756457, 8507645,
    26969006, 7413992,  10225135, 1008833,  5063641,  22231691, 11487714,
    15689486, 2350510,  19320521, 483889,   3045087,  20266013, 19624484,
    3281923,  22499230, 7139367,  10316082, 25469994, 22244800, 2486111,
    4369518,  28271967, 2320515,  15400291, 3918813,  23370493, 7702385,
    3219404,  19204241, 885982,   22838979, 14444604, 12511894, 27809886,
    7198845,  27762689, 19072523, 4713646,  2770372,  28228590, 17964636,
    27239501, 19444327, 8952443,  12933043, 20211527, 26749902, 15815035,
    10624511, 13424815, 12468440, 12290673, 5210757,  17093739, 23537292,
    11988900, 11125757, 15448844, 19647787, 28355233, 17543084, 18719484,
    20869728, 17254503, 13118801, 26318033, 18243224, 116303,   19514368,
    25096016, 8958033,  5222332,  5457879,  21760986, 10902298, 22848208,
    24407456, 16111465, 3987386,  15115967, 27336659, 15563762, 9433072,
    6638983,  24804820, 20227831, 19153072, 1368998,  13745731, 17634148,
    3000841,  25254778, 23327596, 4843166,  22766152, 1763215,  713285,
    15054969, 16856350, 27373372, 13312670, 28910107, 4202932,  6288367,
    22656585, 1917133,  5060958,  22389384, 25692126, 92614,    26297185,
    14975674, 28447385, 1059985,  548824,   15868474, 7532221,  11824836,
    22982512, 12667418, 13890089, 4716537,  23216669, 27154563, 17293966,
    15698210, 10694483, 8616768,  18965917, 13864303, 24906201, 16813976,
    21262176, 24032054, 27044697, 20100255, 27976474, 27402078, 27241828,
    13763291, 14297067, 19776059, 26762098, 23076278, 25121483, 11741326,
    23786581, 10708632, 3242900,  8804303,  12273911, 27464347, 5222400,
    7825867,  4797417,  12856724, 25327180, 7942219,  9948138,  16747228,
    7151256,  11563589, 17687036, 19350891, 10888481, 20953677, 20646916,
    11304636, 13004818, 27565306, 21921177, 22593112, 13240071, 7335983,
    12079856, 19054166, 14848840, 4005355,  6600088,  13372487, 28191470,
    17137686, 806732,   19878555, 11511473, 19372615, 18638108, 1367365,
    20699331, 12756070, 3060130,  19701536, 15163147, 10332375, 20370390,
    10636882, 28377569, 14628934, 1255404,  28469283, 5532539,  20024963,
    16852949, 2408270,  14835911, 27523260, 13455425, 13255211, 21129059,
    25027530, 16048500, 9141733,  20204167, 27428637, 26396836, 6736717,
    24499142, 12655104, 811895,   26827240, 28207939, 8789098,  7679469,
    26498215, 19069139, 6982429,  7985973,  1875398,  3437939,  26461931,
    10125961, 21138798, 25491973, 9407773,  16818129, 21920617, 206143,
    12675148, 5085722,  11365141, 16265849, 13518901, 17013903, 26544953,
    12445119, 20797084, 8698427,  6756323,  19601050, 25302324, 10109542,
    11514901, 12010917, 2446080,  26936274, 6198778,  4684341,  9939486,
    3087460,  28558389, 8040466,  24006159, 12732001, 27083470, 12791440,
    9507586,  6348729,  9124670,  20031384, 9622395,  2107797,  21841111,
    9294202,  15031219, 13180802, 6561201,  12662527, 26458270, 17016638,
    18305231, 17246306, 13489499, 9910499,  18493027, 762130,   2850537,
    18558200, 19148373, 9312483,  15624080, 1975053,  17078337, 16468839,
    14227643, 20316570, 12185702, 21540080, 213644,   16329169, 14598463,
    10538204, 28432356, 26255521, 19204222, 15339175, 5881263,  23491773,
    24112092, 19057308, 1911320,  15765029, 17322623, 1138242,  14752086,
    12209111, 17561948, 23071628, 1644054,  83104,    897912,   22724112,
    8425761,  18474603, 27952173, 22612155, 6929765,  23013843, 22561099,
    15199719, 1508982,  9929274,  18012709, 7171619,  11222235, 22302625,
    22568646, 3950306,  20953009, 27530600, 17725259, 15856266, 16594451,
    19629255, 1676546,  5313769,  17892937, 15609483, 22413440, 25867902,
    16430808, 5493412,  3967487,  19176912, 1435036,  5723391,  8397670,
    3751404,  7654964,  16969794, 7427947,  24633645, 13038641, 27676254,
    14255355, 3259164,  17597254, 5194209,  6062302,  3360007,  5154796,
    10380964, 19694425, 2517428,  26772180, 5215743,  28357335, 26024836,
    621488,   12892124, 27656439, 22423526, 24830349, 2783621,  28708720,
    27697645, 7906984,  1108834,  309731,   22948126, 27046799, 13379747,
    8054025,  13959238, 7829456,  22554962, 3905971,  7624898,  14551869,
    25725878, 11557200, 23066540, 2593142,  25365101, 22272654, 19759350,
    1960198,  9435652,  15816287, 25613402, 19326113, 21617531, 12607206,
    9168822,  10762527, 17625498, 19737182, 6254892,  13919787, 28111302,
    12037102, 24062105, 11208425, 10262178, 23203773, 22329794, 22118160,
    10087110, 17059659, 2622576,  1517991,  14103227, 20817063, 23169934,
    26064833, 23397120,
};

/// NTT reverse table where the i-th element is (1/g)^rev(i) where
/// - g = 10516887 is a primitive root
/// - 1/g = 4800153
/// - rev(i) is the reverse bit decomposition of i, i.e.,
///   0   ->  0
///   1   ->  100 0000
///   2   ->  010 0000
///   3   ->  110 0000   ...
static const uint32_t HOTS_INV_NTT_TABLE[] = {
    1,        26861548, 13464113, 21947001, 9831143,  12356829, 3664746,
    9973724,  10247061, 7355073,  9960599,  9024917,  18602776, 26346173,
    23196713, 542570,   10654447, 3473959,  21668915, 20470755, 12641414,
    23378873, 25301975, 17476131, 28673185, 23090979, 25716122, 1673423,
    8331609,  6871730,  13547867, 9847659,  27837857, 23787733, 7771445,
    343346,   7671090,  11659626, 10666163, 12297305, 4988232,  28396108,
    26943050, 17357069, 1728100,  20276340, 23536511, 12510276, 5411740,
    3558320,  15993456, 14923710, 14645762, 21788764, 4586678,  3679774,
    10120735, 16609831, 26792618, 14492457, 27705679, 16219812, 9137615,
    21378594, 6605326,  17965492, 8413272,  9430678,  12119670, 15886672,
    28557132, 17290930, 1855751,  18612412, 25744033, 12119816, 25582572,
    25874121, 9065375,  26187749, 19615901, 11160010, 16345799, 27800324,
    4792509,  5581576,  28517761, 18155866, 19056088, 1839000,  7961292,
    27049174, 26727961, 13945087, 1560049,  10469107, 2104538,  10165737,
    27371450, 27859588, 24093457, 21563608, 19734242, 28757807, 2836748,
    7903824,  5963303,  9283670,  23727160, 361046,   5637956,  19078679,
    20152301, 21392907, 11266541, 10017350, 2705891,  16200737, 1442611,
    5468092,  6846782,  14353972, 13955474, 11708608, 3273281,  3646179,
    20058545, 8724167,  3953968,  27390822, 801270,   3640989,  19836329,
    22123871, 7979351,  20682874, 17663548, 22962806, 25360780, 1200822,
    15712472, 25924284, 14668907, 25564214, 12672925, 22244259, 4868084,
    16603297, 27851296, 26979883, 23459606, 4240230,  15193891, 13954494,
    19881355, 11625576, 8207771,  19244722, 28096288, 28451224, 11916570,
    6268194,  22228459, 7617554,  26321903, 19211528, 20353564, 12081254,
    17358434, 13627936, 2944898,  15589591, 8477735,  6246556,  24681762,
    25663939, 25341960, 19473737, 26655337, 3017254,  221002,   9776296,
    24641380, 5889809,  5997965,  28493479, 1438162,  8473459,  5669451,
    22110032, 24871788, 338627,   9437740,  22437460, 12819666, 22413126,
    12705196, 11271531, 4852776,  2812950,  22812049, 15273587, 10945268,
    11383544, 27639352, 27393281, 16597245, 15918800, 22447589, 13001156,
    24162717, 18786996, 13690320, 27153820, 5772317,  24196561, 6738644,
    10776242, 23209952, 12414234, 4572199,  10905038, 5566799,  11315024,
    10192718, 22664551, 28467148, 13349648, 16013610, 14555165, 24362151,
    2927253,  28308421, 13181774, 24980128, 20029890, 14440201, 11062623,
    16912066, 23768469, 11130501, 6306767,  11652724, 6608655,  8914161,
    20808175, 15689314, 20109298, 27118148, 2252402,  101074,   5794049,
    12307878, 19119857, 12554579, 14988967, 17278074, 6306742,  10656818,
    17166418, 28534396, 6469992,  4661973,  15280795, 8484630,  6446318,
    23213656, 17149515, 5571076,  16931241, 26118829, 13672122, 28367249,
    7191040,  16008121, 27977946, 20311046, 13257812, 19864606, 27680172,
    14687105, 20976765, 8337628,  25415330, 26680104, 7569766,  8485585,
    27201244, 9974345,  13648338, 19528918, 19607762, 899463,   9196325,
    5799331,  9635166,  28286720, 2285927,  4828766,  23557876, 27917333,
    8140675,  16963821, 9680514,  8906497,  20132987, 20212065, 17598520,
    28550417, 20851625, 10771002, 12368270, 23915409, 5575837,  20923154,
    19772238, 24637331, 20466197, 26725124, 9482477,  3920064,  2479901,
    757289,   22309414, 7858586,  12233024, 12991422, 5957090,  22265845,
    4660145,  21674261, 13543127, 11193217, 537767,   16693420, 852049,
    4893651,  15367802, 20568279, 8001287,  3096926,  15152193, 19112154,
    9828375,  15966198, 13458467, 5367780,  7718273,  6334671,  13795399,
    23601493, 6185948,  11131418, 18874584, 5113422,  25624517, 26827053,
    11441160, 20375712, 24118722, 21407160, 6152926,  21004922, 7648924,
    2324560,  21969583, 20354385, 20714824, 20079758, 16496787, 20431520,
    16110424, 5667190,  12322855, 16923843, 22133450, 11909714, 12187040,
    28056090, 4163547,  2089616,  7975376,  6137520,  22865346, 696435,
    24226069, 14195177, 17923216, 22028620, 22248781, 19527681, 3569138,
    5300313,  4718864,  4755247,  12415302, 25110135, 5225838,  575771,
    9367961,  6178680,  24498393, 6847812,  24621568, 17437557, 4910506,
    3833421,  1958489,  14343176, 19622235, 26640885, 12253089, 10976132,
    17786823, 20433383, 10189578, 17042837, 19782348, 14871557, 11316525,
    19135516, 27619892, 7337322,  24412058, 1208902,  11649511, 24315301,
    25465002, 19285100, 19840363, 28925130, 20509220, 5153327,  19521909,
    15433821, 13500159, 11742638, 10694762, 11732595, 12875123, 3731512,
    16489884, 13912810, 25585822, 19073325, 17837680, 12023995, 9254638,
    13121320, 14109304, 7471203,  9858705,  18070357, 26474760, 21529027,
    20588545, 17868708, 24186427, 23845242, 4029671,  27854170, 12768054,
    10914806, 12414284, 25854449, 19250255, 14755408, 1582229,  11252285,
    18847675, 27873094, 10811427, 13828118, 10695770, 20643072, 16508046,
    28601308, 285496,   4735120,  14794418, 19779592, 13456315, 21473964,
    20856195, 11515648, 5041482,  20959183, 17555933, 6477219,  8174259,
    28670659, 11785636, 14636535, 14015151, 25776482, 9044547,  19865712,
    25391937, 5591555,  9690998,  2736774,  12232546, 2050113,  21512003,
    1155843,  3638164,  1643591,  2941242,  26382182, 20550939, 20026445,
    13143812, 5532929,  2865216,  5760115,  8112986,  14826822, 27412058,
    26307473, 11870390, 18842939, 6811889,  6600255,  5726276,  18667871,
    17721624, 4867944,  16892947, 818747,   15010262, 22675157, 9192867,
    11304551, 18167522, 19761227, 16322843, 7312518,  9603936,  3316647,
    13113762, 19494397, 26969851, 9170699,  6657395,  3564948,  26336907,
    5863509,  17372849, 3204171,  14378180, 21305151, 25024078, 6375087,
    21100593, 14970811, 20876024, 15550302, 1883250,  5981923,  28620318,
    27821215, 21023065, 1232404,  221329,   26146428, 4099700,  6506523,
    1273610,  16037925, 28308561, 2905213,  572714,   23714306, 2157869,
    26412621, 9235624,  18549085, 23775253, 25570042, 22867747, 23735840,
    11332795, 25670885, 14674694, 1253795,  15891408, 4296404,  21502102,
    11960255, 21275085, 25178645, 20532379, 23206658, 27495013, 9753137,
    24962562, 23436637, 12499241, 3062147,  6516609,  13320566, 11037112,
    23616280, 27253503, 9300794,  12335598, 13073783, 11204790, 1399449,
    7977040,  24979743, 6361403,  6627424,  17707814, 21758430, 10917340,
    19000775, 27421067, 13730330, 6368950,  5916206,  22000284, 6317894,
    977876,   10455446, 20504288, 6205937,  28032137, 28846945, 27285995,
    5858421,  11368101, 16720938, 14177963, 27791807, 11607426, 13165020,
    27018729, 9872741,  4817957,  5438276,  23048786, 13590874, 9725827,
    2674528,  497693,   18391845, 14331586, 12600880, 28716405, 7389969,
    16744347, 8613479,  14702406, 12461210, 11851712, 26954996, 13305969,
    19617566, 9781676,  10371849, 26079512, 28167919, 10437022, 19019550,
    15440550, 11683743, 10624818, 11913411, 2471779,  16267522, 22368848,
    15749247, 13898830, 19635847, 7088938,  26822252, 19307654, 8898665,
    19805379, 22581320, 19422463, 16138609, 1846579,  16198048, 4923890,
    20889583, 371660,   25842589, 18990563, 24245708, 22731271, 1993775,
    26483969, 16919132, 17415148, 18820507, 3627725,  9328999,  22173726,
    20231622, 8132965,  16484930, 2385096,  11916146, 15411148, 12664200,
    17564908, 23844327, 16254901, 28723906, 7009432,  12111920, 19522276,
    3438076,  7791251,  18804088, 2468118,  25492110, 27054651, 20944076,
    21947620, 9860910,  2431834,  21250580, 20140951, 722110,   2102809,
    28118154, 16274945, 4430907,  22193332, 2533213,  1501412,  8725882,
    19788316, 12881549, 3902519,  7800990,  15674838, 15474624, 1406789,
    14094138, 26521779, 12077100, 8905086,  23397510, 460766,   27674645,
    14301115, 552480,   18293167, 8559659,  18597674, 13766902, 9228513,
    25869919, 16173979, 8230718,  27562684, 10291941, 9557434,  17418576,
    9051494,  28123317, 11792363, 738579,   15557562, 22329961, 24924694,
    14081209, 9875883,  16850193, 21594066, 15689978, 6336937,  7008872,
    1364743,  15925231, 17625413, 8283133,  7976372,  18041568, 9579158,
    11243013, 17366460, 21778793, 12182821, 18981911, 20987830, 3602869,
    16073325, 24132632, 21104182, 23707649, 1465702,  16656138, 20125746,
    25687149, 18221417, 5143468,  17188723, 3808566,  5853771,  2167951,
    9153990,  14632982, 15166758, 1688221,  1527971,  953575,   8829794,
    1885352,  4897995,  7667873,  12116073, 4023848,  15065746, 9964132,
    20313281, 18235566, 13231839, 11636083, 1775486,  5713380,  24213512,
    15039960, 16262631, 5947537,  17105213, 21397828, 13061575, 28381225,
    27870064, 482664,   13954375, 2632864,  28837435, 3237923,  6540665,
    23869091, 27012916, 6273464,  22641682, 24727117, 19942,    15617379,
    1556677,  12073699, 13875080, 28216764, 27166834, 6163897,  24086883,
    5602453,  3675271,  25929208, 11295901, 15184318, 27561051, 9776977,
    8702218,  4125229,  22291066, 19496977, 13366287, 1593390,  13814082,
    24942663, 12818584, 4522593,  6081841,  18027751, 7169063,  23472170,
    23707717, 19972016, 3834033,  9415681,  28813746, 10686825, 2612016,
    15811248, 11675546, 8060321,  10210565, 11386965, 574816,   9282262,
    13481205, 17804292, 16941149, 5392757,  11836310, 23719292, 16639376,
    16461609, 15505234, 18305538, 13115014, 2180147,  8718522,  15997006,
    19977606, 9485722,  1690548,  10965413, 701459,   26159677, 24216403,
    9857526,  1167360,  21731204, 1120163,  16418155, 14485445, 6091070,
    28044067, 9725808,  25710645, 21227664, 5559556,  25011236, 13529758,
    26609534, 658082,   24560531, 26443938, 6685249,  3460055,  18613967,
    21790682, 6430819,  25648126, 9305565,  8664036,  25884962, 28446160,
    9609528,  26579539, 13240563, 17442335, 6698358,  23866408, 27921216,
    18704914, 21516057, 1961043,  20422404, 10173592, 27840586, 20208059,
    1119357,  25397858, 11178742, 28419076, 2046186,  15171661, 22790367,
    22936319, 10441858, 7288248,  9468369,  23127641, 13312094, 3767890,
    26834151, 25685954, 19981907, 26765334, 17941817, 15512941, 482845,
    15646331, 5820352,  9539292,  12340135, 8176094,  26552032, 12171145,
    21013736, 1811980,  7783910,  22082089, 25289576, 3866567,  8224516,
    11464130, 18358388, 19492335, 1462031,  19016733, 843554,   23612881,
    580594,   13854543, 12155882, 11225321, 3971242,  24715063, 26744231,
    5080804,  4347531,  4580570,  6416981,  8816454,  2425431,  13718600,
    18782004, 2696831,  27064240, 14595464, 12493809, 16731832, 4618665,
    1560350,  7412354,  1427862,  705379,   9854436,  11714522, 19270388,
    4422652,  10128,
};

/// convert a polynomial into its NTT form
void hots_ntt(uint32_t *p) {
  unsigned int t, ht, i, j, j1, j2, l, m;
  uint32_t u, v, s;

  t = N;
  for (l = 0; l < 9; l++) {
    m = 1 << l;
    ht = t >> 1;
    i = 0;
    j1 = 0;
    while (i < m) {
      s = HOTS_NTT_TABLE[m + i];
      j2 = j1 + ht;
      j = j1;
      while (j < j2) {
        u = p[j];
        v = (uint32_t)(((uint64_t)p[j + ht]) * ((uint64_t)s) % 28930049);
        p[j] = ((u + v) % 28930049);
        p[j + ht] = (u + 28930049 - v) % 28930049;
        j++;
      }
      i++;
      j1 += t;
    }
    t = ht;
  }
}

/// convert an NTT form polynomial into its integer form
void hots_inv_ntt(uint32_t *p) {
  unsigned int t, m, hm, dt, i, j, j1, j2;
  uint32_t s, u, v;

  t = 1;
  m = N;

  while (m > 1) {
    hm = m >> 1;
    dt = t << 1;
    i = 0;
    j1 = 0;
    while (i < hm) {
      j2 = j1 + t;
      s = HOTS_INV_NTT_TABLE[hm + i];
      j = j1;
      while (j < j2) {
        u = p[j];
        v = p[j + t];
        p[j] = (u + v) % 28930049;
        p[j + t] = (uint32_t)(((uint64_t)(u + 28930049 - v)) * ((uint64_t)s) %
                              28930049);
        j++;
      }
      i++;
      j1 += dt;
    }
    t = dt;
    m = hm;
  }

  for (i = 0; i < N; i++) {
    p[i] = (uint32_t)(((uint64_t)p[i]) * 28873545 % 28930049);
  }
}
