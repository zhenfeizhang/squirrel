// NTT functions for large ring with q = 28840961 and n = 512
#include "params.h"
#include <stdint.h>

/// NTT forward table where the i-th element is g^rev(i) where
/// - g = 10516887 is a primitive root
/// - rev(i) is the reverse bit decomposition of i, i.e.,
///   0   ->  0
///   1   ->  100 0000
///   2   ->  010 0000
///   3   ->  110 0000   ...
static const uint32_t HOTS_NTT_TABLE[] = {
    1,        28840960, 17937907, 10903054, 4970727,  23870234, 12030399,
    16810562, 13179895, 15661066, 19557766, 9283195,  3815076,  25025885,
    11723990, 17116971, 13769895, 15071066, 21003050, 7837911,  10784830,
    18056131, 13586124, 15254837, 14274946, 14566015, 27361026, 1479935,
    19976662, 8864299,  24536642, 4304319,  28656367, 184594,   727652,
    28113309, 8794377,  20046584, 14523994, 14316967, 7409447,  21431514,
    7559054,  21281907, 27287515, 1553446,  18662419, 10178542, 418183,
    28422778, 24534569, 4306392,  18946888, 9894073,  6472021,  22368940,
    13860802, 14980159, 5538798,  23302163, 4487271,  24353690, 11826897,
    17014064, 7908060,  20932901, 8879608,  19961353, 19564670, 9276291,
    15884460, 12956501, 3247513,  25593448, 7487310,  21353651, 12793524,
    16047437, 17307296, 11533665, 12181738, 16659223, 15641660, 13199301,
    6067689,  22773272, 7271307,  21569654, 2990635,  25850326, 16470012,
    12370949, 18249571, 10591390, 10285085, 18555876, 4813375,  24027586,
    24818322, 4022639,  2124362,  26716599, 26813708, 2027253,  16800624,
    12040337, 4030902,  24810059, 5481268,  23359693, 5615990,  23224971,
    25143837, 3697124,  27383514, 1457447,  8578130,  20262831, 18680582,
    10160379, 20398272, 8442689,  4508687,  24332274, 7140431,  21700530,
    6641179,  22199782, 25776059, 3064902,  10661331, 18179630, 13910081,
    14930880, 21044162, 7796799,  24886686, 3954275,  13440014, 15400947,
    12550873, 16290088, 15228998, 13611963, 3279464,  25561497, 13976875,
    14864086, 5319674,  23521287, 8257537,  20583424, 23518254, 5322707,
    8963939,  19877022, 22471698, 6369263,  27735923, 1105038,  18228812,
    10612149, 2921143,  25919818, 22106677, 6734284,  20678784, 8162177,
    28398362, 442599,   11202826, 17638135, 7387529,  21453432, 4493780,
    24347181, 2393774,  26447187, 7425388,  21415573, 25978733, 2862228,
    10685794, 18155167, 14757571, 14083390, 3099687,  25741274, 25959057,
    2881904,  20108380, 8732581,  24417943, 4423018,  10028092, 18812869,
    22621980, 6218981,  7651027,  21189934, 23802945, 5038016,  16045250,
    12795711, 4278668,  24562293, 23415999, 5424962,  2175186,  26665775,
    11380905, 17460056, 10229010, 18611951, 28653162, 187799,   304562,
    28536399, 5794309,  23046652, 3672723,  25168238, 17853837, 10987124,
    3819743,  25021218, 2626176,  26214785, 967070,   27873891, 8182132,
    20658829, 10738059, 18102902, 23293317, 5547644,  22117154, 6723807,
    28428547, 412414,   26415519, 2425442,  15344553, 13496408, 3844730,
    24996231, 28574445, 266516,   19556122, 9284839,  1204100,  27636861,
    1840765,  27000196, 3108214,  25732747, 10954243, 17886718, 13846067,
    14994894, 28397023, 443938,   16865866, 11975095, 27168638, 1672323,
    28225437, 615524,   24895404, 3945557,  20422698, 8418263,  1906226,
    26934735, 5552187,  23288774, 6242245,  22598716, 28793673, 47288,
    7102833,  21738128, 23086778, 5754183,  4542221,  24298740, 2292450,
    26548511, 9925290,  18915671, 13912983, 14927978, 11120971, 17719990,
    15230585, 13610376, 15986279, 12854682, 17491877, 11349084, 5360725,
    23480236, 9861542,  18979419, 10682917, 18158044, 20823979, 8016982,
    1941303,  26899658, 19110850, 9730111,  27414180, 1426781,  3904033,
    24936928, 26515879, 2325082,  10905453, 17935508, 13916097, 14924864,
    12616612, 16224349, 6478406,  22362555, 15974137, 12866824, 18997404,
    9843557,  3628374,  25212587, 7532274,  21308687, 19328470, 9512491,
    13768002, 15072959, 10356196, 18484765, 3351905,  25489056, 24400007,
    4440954,  12164976, 16675985, 7462951,  21378010, 8278044,  20562917,
    9722581,  19118380, 7545691,  21295270, 14407144, 14433817, 15570701,
    13270260, 27689184, 1151777,  23335936, 5505025,  26408108, 2432853,
    10143054, 18697907, 24535091, 4305870,  3763093,  25077868, 2614500,
    26226461, 12425724, 16415237, 26828173, 2012788,  4484677,  24356284,
    1366232,  27474729, 3382527,  25458434, 14044955, 14796006, 23738992,
    5101969,  11143615, 17697346, 25287940, 3553021,  4784388,  24056573,
    5882270,  22958691, 4638677,  24202284, 19002724, 9838237,  27394626,
    1446335,  4112801,  24728160, 7814312,  21026649, 13022048, 15818913,
    7256751,  21584210, 16386966, 12453995, 18902215, 9938746,  11965436,
    16875525, 13806037, 15034924, 20125092, 8715869,  8235054,  20605907,
    22905334, 5935627,  27430231, 1410730,  1592309,  27248652, 16189952,
    12651009, 21888530, 6952431,  3987013,  24853948, 11069570, 17771391,
    5555087,  23285874, 15647955, 13193006, 23421473, 5419488,  19751720,
    9089241,  1667992,  27172969, 8464240,  20376721, 19924787, 8916174,
    10488317, 18352644, 12154492, 16686469, 24299043, 4541918,  10792703,
    18048258, 17667949, 11173012, 2376876,  26464085, 7903380,  20937581,
    15512319, 13328642, 8105789,  20735172, 20749992, 8090969,  5333734,
    23507227, 1026012,  27814949, 10310969, 18529992, 4745039,  24095922,
    28620973, 219988,   11362748, 17478213, 13323632, 15517329, 7423786,
    21417175, 4075022,  24765939, 7686376,  21154585, 25015057, 3825904,
    491349,   28349612, 3484465,  25356496, 22640360, 6200601,  17882975,
    10957986, 15166201, 13674760, 26273583, 2567378,  2931759,  25909202,
    16209609, 12631352, 23097365, 5743596,  391784,   28449177, 21466335,
    7374626,  28821317, 19644,    6616390,  22224571, 10532758, 18308203,
    26517439, 2323522,  28290478, 550483,   26527138, 2313823,  14304695,
    14536266, 17854986, 10985975, 3555839,  25285122, 14873866, 13967095,
    8498986,  20341975, 8433238,  20407723, 3624579,  25216382, 154452,
    28686509, 17407999, 11432962, 21185745, 7655216,  21044411, 7796550,
    11120768, 17720193, 614602,   28226359, 14289037, 14551924, 9153299,
    19687662, 12051413, 16789548, 2156486,  26684475, 21737396, 7103565,
    4887033,  23953928, 4225835,  24615126, 28774794, 66167,    23416525,
    5424436,  5918313,  22922648, 12797941, 16043020, 18866253, 9974708,
    15217148, 13623813, 20326267, 8514694,  27953537, 887424,   6268806,
    22572155, 24865780, 3975181,  2060360,  26780601, 8183460,  20657501,
    4148698,  24692263, 21566605, 7274356,  24233106, 4607855,  6829454,
    22011507, 6009097,  22831864, 11725125, 17115836, 1003617,  27837344,
    984770,   27856191, 27413467, 1427494,  19563026, 9277935,  15572619,
    13268342, 25328337, 3512624,  1903439,  26937522, 22831752, 6009209,
    24499828, 4341133,  14240018, 14600943, 18119782, 10721179, 25009226,
    3831735,  4764058,  24076903, 19855556, 8985405,  8949403,  19891558,
    11034956, 17806005, 12656966, 16183995, 1943803,  26897158, 15807740,
    13033221, 17187288, 11653673, 15849281, 12991680, 11872618, 16968343,
    18474311, 10366650, 14816646, 14024315, 9070127,  19770834, 23362939,
    5478022,  12026377, 16814584, 8851741,  19989220, 8916058,  19924903,
    4216220,  24624741, 19966608, 8874353,  19348797, 9492164,  10772683,
    18068278, 15290150, 13550811, 5713554,  23127407, 18963800, 9877161,
    2588848,  26252113, 10579298, 18261663, 23627750, 5213211,  10902789,
    17938172, 13285495, 15555466, 17059447, 11781514, 7096076,  21744885,
    6367301,  22473660, 16310935, 12530026, 13258866, 15582095, 14573843,
    14267118, 21617783, 7223178,  11615248, 17225713, 21858204, 6982757,
    26156694, 2684267,  25626097, 3214864,  16791060, 12049901, 20765343,
    8075618,  24192929, 4648032,  22314344, 6526617,  13449113, 15391848,
    9971769,  18869192, 21247123, 7593838,  602633,   28238328, 12950418,
    15890543, 8631852,  20209109, 25143808, 3697153,  26321509, 2519452,
    16103960, 12737001, 11867071, 16973890, 13113810, 15727151, 14152693,
    14688268, 9149030,  19691931, 7877885,  20963076, 9070219,  19770742,
    874645,   27966316, 4357758,  24483203, 16768078, 12072883, 19704289,
    9136672,  25991536, 2849425,  115076,   28725885, 17325240, 11515721,
    8600739,  20240222, 15226363, 13614598, 1139952,  27701009, 25088581,
    3752380,  6577434,  22263527, 27399582, 1441379,  26101490, 2739471,
    6963043,  21877918, 10747850, 18093111, 11888264, 16952697, 1258433,
    27582528, 6990797,  21850164, 10859501, 17981460, 23128959, 5712002,
    18504795, 10336166, 9353074,  19487887, 9105392,  19735569, 6014720,
    22826241, 4517866,  24323095, 7444693,  21396268, 6544010,  22296951,
    16693282, 12147679, 21340561, 7500400,  19149345, 9691616,  9925251,
    18915710, 6517674,  22323287, 14759653, 14081308, 777566,   28063395,
    21107672, 7733289,  4603989,  24236972, 20451649, 8389312,  13947348,
    14893613, 21635271, 7205690,  9251937,  19589024, 23112833, 5728128,
    26132008, 2708953,  18669545, 10171416, 3939576,  24901385, 15659851,
    13181110, 18492706, 10348255, 13353429, 15487532, 22549413, 6291548,
    17031164, 11809797, 19076736, 9764225,  18980435, 9860526,  2786885,
    26054076, 11900970, 16939991, 7024670,  21816291, 27933104, 907857,
    23034312, 5806649,  7414302,  21426659, 25236280, 3604681,  20282743,
    8558218,  23303539, 5537422,  14985536, 13855425, 2413557,  26427404,
    16381922, 12459039, 14193964, 14646997, 15948311, 12892650, 1491955,
    27349006, 12046773, 16794188, 22812628, 6028333,  26025112, 2815849,
    6513541,  22327420, 18971648, 9869313,  27090902, 1750059,  12140867,
    16700094, 12673283, 16167678, 3213756,  25627205, 22377867, 6463094,
    739561,   28101400, 26561891, 2279070,  418904,   28422057, 8174027,
    20666934, 14418847, 14422114, 15265772, 13575189, 27888928, 952033,
    3458155,  25382806, 20509878, 8331083,  16090475, 12750486, 14213158,
    14627803, 9253579,  19587382, 17246578, 11594383, 12261415, 16579546,
    4807366,  24033595, 14606416, 14234545, 14586140, 14254821, 28390434,
    450527,   24292426, 4548535,  25057560, 3783401,  13124689, 15716272,
    22700820, 6140141,  11604229, 17236732, 11166704, 17674257, 10212860,
    18628101, 10067396, 18773565, 27375279, 1465682,  8435221,  20405740,
    23501614, 5339347,  26137809, 2703152,  25450566, 3390395,  27006864,
    1834097,  7326236,  21514725, 11475271, 17365690, 16344819, 12496142,
    26887540, 1953421,  2934518,  25906443, 2163715,  26677246, 25737304,
    3103657,  9599490,  19241471, 826565,   28014396, 25299926, 3541035,
    3340617,  25500344, 4852011,  23988950, 1394067,  27446894, 2439836,
    26401125, 24141083, 4699878,  19216428, 9624533,  2294067,  26546894,
    15887593, 12953368, 12775568, 16065393, 20101652, 8739309,  25354771,
    3486190,  9662179,  19178782, 19610954, 9230007,  9227741,  19613220,
    18585041, 10255920, 2274686,  26566275, 19573604, 9267357,  3925321,
    24915640, 11491205, 17349756, 1360392,  27480569, 4331691,  24509270,
    27847002, 993959,
};

/// NTT reverse table where the i-th element is (1/g)^rev(i) where
/// - g = 10516887 is a primitive root
/// - 1/g = 4800153
/// - rev(i) is the reverse bit decomposition of i, i.e.,
///   0   ->  0
///   1   ->  100 0000
///   2   ->  010 0000
///   3   ->  110 0000   ...
static const uint32_t HOTS_INV_NTT_TABLE[] = {
    1,        28840960, 10903054, 17937907, 16810562, 12030399, 23870234,
    4970727,  17116971, 11723990, 25025885, 3815076,  9283195,  19557766,
    15661066, 13179895, 4304319,  24536642, 8864299,  19976662, 1479935,
    27361026, 14566015, 14274946, 15254837, 13586124, 18056131, 10784830,
    7837911,  21003050, 15071066, 13769895, 17014064, 11826897, 24353690,
    4487271,  23302163, 5538798,  14980159, 13860802, 22368940, 6472021,
    9894073,  18946888, 4306392,  24534569, 28422778, 418183,   10178542,
    18662419, 1553446,  27287515, 21281907, 7559054,  21431514, 7409447,
    14316967, 14523994, 20046584, 8794377,  28113309, 727652,   184594,
    28656367, 22199782, 6641179,  21700530, 7140431,  24332274, 4508687,
    8442689,  20398272, 10160379, 18680582, 20262831, 8578130,  1457447,
    27383514, 3697124,  25143837, 23224971, 5615990,  23359693, 5481268,
    24810059, 4030902,  12040337, 16800624, 2027253,  26813708, 26716599,
    2124362,  4022639,  24818322, 24027586, 4813375,  18555876, 10285085,
    10591390, 18249571, 12370949, 16470012, 25850326, 2990635,  21569654,
    7271307,  22773272, 6067689,  13199301, 15641660, 16659223, 12181738,
    11533665, 17307296, 16047437, 12793524, 21353651, 7487310,  25593448,
    3247513,  12956501, 15884460, 9276291,  19564670, 19961353, 8879608,
    20932901, 7908060,  25732747, 3108214,  27000196, 1840765,  27636861,
    1204100,  9284839,  19556122, 266516,   28574445, 24996231, 3844730,
    13496408, 15344553, 2425442,  26415519, 412414,   28428547, 6723807,
    22117154, 5547644,  23293317, 18102902, 10738059, 20658829, 8182132,
    27873891, 967070,   26214785, 2626176,  25021218, 3819743,  10987124,
    17853837, 25168238, 3672723,  23046652, 5794309,  28536399, 304562,
    187799,   28653162, 18611951, 10229010, 17460056, 11380905, 26665775,
    2175186,  5424962,  23415999, 24562293, 4278668,  12795711, 16045250,
    5038016,  23802945, 21189934, 7651027,  6218981,  22621980, 18812869,
    10028092, 4423018,  24417943, 8732581,  20108380, 2881904,  25959057,
    25741274, 3099687,  14083390, 14757571, 18155167, 10685794, 2862228,
    25978733, 21415573, 7425388,  26447187, 2393774,  24347181, 4493780,
    21453432, 7387529,  17638135, 11202826, 442599,   28398362, 8162177,
    20678784, 6734284,  22106677, 25919818, 2921143,  10612149, 18228812,
    1105038,  27735923, 6369263,  22471698, 19877022, 8963939,  5322707,
    23518254, 20583424, 8257537,  23521287, 5319674,  14864086, 13976875,
    25561497, 3279464,  13611963, 15228998, 16290088, 12550873, 15400947,
    13440014, 3954275,  24886686, 7796799,  21044162, 14930880, 13910081,
    18179630, 10661331, 3064902,  25776059, 7374626,  21466335, 28449177,
    391784,   5743596,  23097365, 12631352, 16209609, 25909202, 2931759,
    2567378,  26273583, 13674760, 15166201, 10957986, 17882975, 6200601,
    22640360, 25356496, 3484465,  28349612, 491349,   3825904,  25015057,
    21154585, 7686376,  24765939, 4075022,  21417175, 7423786,  15517329,
    13323632, 17478213, 11362748, 219988,   28620973, 24095922, 4745039,
    18529992, 10310969, 27814949, 1026012,  23507227, 5333734,  8090969,
    20749992, 20735172, 8105789,  13328642, 15512319, 20937581, 7903380,
    26464085, 2376876,  11173012, 17667949, 18048258, 10792703, 4541918,
    24299043, 16686469, 12154492, 18352644, 10488317, 8916174,  19924787,
    20376721, 8464240,  27172969, 1667992,  9089241,  19751720, 5419488,
    23421473, 13193006, 15647955, 23285874, 5555087,  17771391, 11069570,
    24853948, 3987013,  6952431,  21888530, 12651009, 16189952, 27248652,
    1592309,  1410730,  27430231, 5935627,  22905334, 20605907, 8235054,
    8715869,  20125092, 15034924, 13806037, 16875525, 11965436, 9938746,
    18902215, 12453995, 16386966, 21584210, 7256751,  15818913, 13022048,
    21026649, 7814312,  24728160, 4112801,  1446335,  27394626, 9838237,
    19002724, 24202284, 4638677,  22958691, 5882270,  24056573, 4784388,
    3553021,  25287940, 17697346, 11143615, 5101969,  23738992, 14796006,
    14044955, 25458434, 3382527,  27474729, 1366232,  24356284, 4484677,
    2012788,  26828173, 16415237, 12425724, 26226461, 2614500,  25077868,
    3763093,  4305870,  24535091, 18697907, 10143054, 2432853,  26408108,
    5505025,  23335936, 1151777,  27689184, 13270260, 15570701, 14433817,
    14407144, 21295270, 7545691,  19118380, 9722581,  20562917, 8278044,
    21378010, 7462951,  16675985, 12164976, 4440954,  24400007, 25489056,
    3351905,  18484765, 10356196, 15072959, 13768002, 9512491,  19328470,
    21308687, 7532274,  25212587, 3628374,  9843557,  18997404, 12866824,
    15974137, 22362555, 6478406,  16224349, 12616612, 14924864, 13916097,
    17935508, 10905453, 2325082,  26515879, 24936928, 3904033,  1426781,
    27414180, 9730111,  19110850, 26899658, 1941303,  8016982,  20823979,
    18158044, 10682917, 18979419, 9861542,  23480236, 5360725,  11349084,
    17491877, 12854682, 15986279, 13610376, 15230585, 17719990, 11120971,
    14927978, 13912983, 18915671, 9925290,  26548511, 2292450,  24298740,
    4542221,  5754183,  23086778, 21738128, 7102833,  47288,    28793673,
    22598716, 6242245,  23288774, 5552187,  26934735, 1906226,  8418263,
    20422698, 3945557,  24895404, 615524,   28225437, 1672323,  27168638,
    11975095, 16865866, 443938,   28397023, 14994894, 13846067, 17886718,
    10954243, 993959,   27847002, 24509270, 4331691,  27480569, 1360392,
    17349756, 11491205, 24915640, 3925321,  9267357,  19573604, 26566275,
    2274686,  10255920, 18585041, 19613220, 9227741,  9230007,  19610954,
    19178782, 9662179,  3486190,  25354771, 8739309,  20101652, 16065393,
    12775568, 12953368, 15887593, 26546894, 2294067,  9624533,  19216428,
    4699878,  24141083, 26401125, 2439836,  27446894, 1394067,  23988950,
    4852011,  25500344, 3340617,  3541035,  25299926, 28014396, 826565,
    19241471, 9599490,  3103657,  25737304, 26677246, 2163715,  25906443,
    2934518,  1953421,  26887540, 12496142, 16344819, 17365690, 11475271,
    21514725, 7326236,  1834097,  27006864, 3390395,  25450566, 2703152,
    26137809, 5339347,  23501614, 20405740, 8435221,  1465682,  27375279,
    18773565, 10067396, 18628101, 10212860, 17674257, 11166704, 17236732,
    11604229, 6140141,  22700820, 15716272, 13124689, 3783401,  25057560,
    4548535,  24292426, 450527,   28390434, 14254821, 14586140, 14234545,
    14606416, 24033595, 4807366,  16579546, 12261415, 11594383, 17246578,
    19587382, 9253579,  14627803, 14213158, 12750486, 16090475, 8331083,
    20509878, 25382806, 3458155,  952033,   27888928, 13575189, 15265772,
    14422114, 14418847, 20666934, 8174027,  28422057, 418904,   2279070,
    26561891, 28101400, 739561,   6463094,  22377867, 25627205, 3213756,
    16167678, 12673283, 16700094, 12140867, 1750059,  27090902, 9869313,
    18971648, 22327420, 6513541,  2815849,  26025112, 6028333,  22812628,
    16794188, 12046773, 27349006, 1491955,  12892650, 15948311, 14646997,
    14193964, 12459039, 16381922, 26427404, 2413557,  13855425, 14985536,
    5537422,  23303539, 8558218,  20282743, 3604681,  25236280, 21426659,
    7414302,  5806649,  23034312, 907857,   27933104, 21816291, 7024670,
    16939991, 11900970, 26054076, 2786885,  9860526,  18980435, 9764225,
    19076736, 11809797, 17031164, 6291548,  22549413, 15487532, 13353429,
    10348255, 18492706, 13181110, 15659851, 24901385, 3939576,  10171416,
    18669545, 2708953,  26132008, 5728128,  23112833, 19589024, 9251937,
    7205690,  21635271, 14893613, 13947348, 8389312,  20451649, 24236972,
    4603989,  7733289,  21107672, 28063395, 777566,   14081308, 14759653,
    22323287, 6517674,  18915710, 9925251,  9691616,  19149345, 7500400,
    21340561, 12147679, 16693282, 22296951, 6544010,  21396268, 7444693,
    24323095, 4517866,  22826241, 6014720,  19735569, 9105392,  19487887,
    9353074,  10336166, 18504795, 5712002,  23128959, 17981460, 10859501,
    21850164, 6990797,  27582528, 1258433,  16952697, 11888264, 18093111,
    10747850, 21877918, 6963043,  2739471,  26101490, 1441379,  27399582,
    22263527, 6577434,  3752380,  25088581, 27701009, 1139952,  13614598,
    15226363, 20240222, 8600739,  11515721, 17325240, 28725885, 115076,
    2849425,  25991536, 9136672,  19704289, 12072883, 16768078, 24483203,
    4357758,  27966316, 874645,   19770742, 9070219,  20963076, 7877885,
    19691931, 9149030,  14688268, 14152693, 15727151, 13113810, 16973890,
    11867071, 12737001, 16103960, 2519452,  26321509, 3697153,  25143808,
    20209109, 8631852,  15890543, 12950418, 28238328, 602633,   7593838,
    21247123, 18869192, 9971769,  15391848, 13449113, 6526617,  22314344,
    4648032,  24192929, 8075618,  20765343, 12049901, 16791060, 3214864,
    25626097, 2684267,  26156694, 6982757,  21858204, 17225713, 11615248,
    7223178,  21617783, 14267118, 14573843, 15582095, 13258866, 12530026,
    16310935, 22473660, 6367301,  21744885, 7096076,  11781514, 17059447,
    15555466, 13285495, 17938172, 10902789, 5213211,  23627750, 18261663,
    10579298, 26252113, 2588848,  9877161,  18963800, 23127407, 5713554,
    13550811, 15290150, 18068278, 10772683, 9492164,  19348797, 8874353,
    19966608, 24624741, 4216220,  19924903, 8916058,  19989220, 8851741,
    16814584, 12026377, 5478022,  23362939, 19770834, 9070127,  14024315,
    14816646, 10366650, 18474311, 16968343, 11872618, 12991680, 15849281,
    11653673, 17187288, 13033221, 15807740, 26897158, 1943803,  16183995,
    12656966, 17806005, 11034956, 19891558, 8949403,  8985405,  19855556,
    24076903, 4764058,  3831735,  25009226, 10721179, 18119782, 14600943,
    14240018, 4341133,  24499828, 6009209,  22831752, 26937522, 1903439,
    3512624,  25328337, 13268342, 15572619, 9277935,  19563026, 1427494,
    27413467, 27856191, 984770,   27837344, 1003617,  17115836, 11725125,
    22831864, 6009097,  22011507, 6829454,  4607855,  24233106, 7274356,
    21566605, 24692263, 4148698,  20657501, 8183460,  26780601, 2060360,
    3975181,  24865780, 22572155, 6268806,  887424,   27953537, 8514694,
    20326267, 13623813, 15217148, 9974708,  18866253, 16043020, 12797941,
    22922648, 5918313,  5424436,  23416525, 66167,    28774794, 24615126,
    4225835,  23953928, 4887033,  7103565,  21737396, 26684475, 2156486,
    16789548, 12051413, 19687662, 9153299,  14551924, 14289037, 28226359,
    614602,   17720193, 11120768, 7796550,  21044411, 7655216,  21185745,
    11432962, 17407999, 28686509, 154452,   25216382, 3624579,  20407723,
    8433238,  20341975, 8498986,  13967095, 14873866, 25285122, 3555839,
    10985975, 17854986, 14536266, 14304695, 2313823,  26527138, 550483,
    28290478, 2323522,  26517439, 18308203, 10532758, 22224571, 6616390,
    19644,    28821317,

};

/// convert a polynomial into its NTT form
void hots_ntt(uint32_t *p) {
  unsigned int t, ht, i, j, j1, j2, l, m;
  uint32_t u, v, s;

  t = N;
  for (l = 0; l < 9; l++) {
    m = 1 << l;
    ht = t >> 1;
    i = 0;
    j1 = 0;
    while (i < m) {
      s = HOTS_NTT_TABLE[m + i];
      j2 = j1 + ht;
      j = j1;
      while (j < j2) {
        u = p[j];
        v = (uint32_t)(((uint64_t)p[j + ht]) * ((uint64_t)s) % 28840961);
        p[j] = ((u + v) % 28840961);
        p[j + ht] = (u + 28840961 - v) % 28840961;
        j++;
      }
      i++;
      j1 += t;
    }
    t = ht;
  }
}

/// convert an NTT form polynomial into its integer form
void hots_inv_ntt(uint32_t *p) {
  unsigned int t, m, hm, dt, i, j, j1, j2;
  uint32_t s, u, v;

  t = 1;
  m = N;

  while (m > 1) {
    hm = m >> 1;
    dt = t << 1;
    i = 0;
    j1 = 0;
    while (i < hm) {
      j2 = j1 + t;
      s = HOTS_INV_NTT_TABLE[hm + i];
      j = j1;
      while (j < j2) {
        u = p[j];
        v = p[j + t];
        p[j] = (u + v) % 28840961;
        p[j + t] = (uint32_t)(((uint64_t)(u + 28840961 - v)) * ((uint64_t)s) %
                              28840961);
        j++;
      }
      i++;
      j1 += dt;
    }
    t = dt;
    m = hm;
  }

  for (i = 0; i < N; i++) {
    p[i] = (uint32_t)(((uint64_t)p[i]) * 28784631 % 28840961);
  }
}
